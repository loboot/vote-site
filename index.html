<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      .panel {
        background: center / contain no-repeat url('./assets/image/12.5-投票_画板 1.jpg');
      }

      .container {
        width: 100vw;
        aspect-ratio: 16 / 9; /* 新方式，简洁且适配 */
        margin: 0 auto;
      }

      .wrapper {
        min-width: 80%;
        margin-left: 10%;
        margin-right: 10%;
      }

      .icon1 {
        width: 34%;
      }
      .icon2 {
        width: 44%;
      }
      .icon3 {
        width: 14%;
      }
    </style>
  </head>
  <body>
    <div class="container panel relative">
      <div class="w-full h-full flex flex-col justify-center items-center relative">
        <div class="wrapper flex items-center justify-bewteen">
          <div class="flex-1 flex items-center" style="min-width: 60%">
            <img class="icon1 h-20 object-contain" src="./assets/image/资源 4.png" alt="" />
            <img class="icon2 object-contain bottom-4 relative" src="./assets/image/资源 1.png" alt="" />
          </div>
          <div class="flex flex-wrap items-center justify-bewteen gap-2 flex-grow" id="redHeartsContainer">
            <!-- Heart icons will be generated by JavaScript -->
          </div>
        </div>

        <div class="wrapper flex items-center justify-center">
          <div class="flex-1 flex items-center" style="min-width: 60%">
            <img class="icon1 h-20 object-contain" src="./assets/image/资源 5.png" alt="" />
            <img class="icon2 object-contain bottom-4 relative" src="./assets/image/资源 2.png" alt="" />
          </div>
          <div class="flex flex-wrap items-center justify-bewteen gap-2 flex-grow" id="yellowHeartsContainer">
            <!-- Heart icons will be generated by JavaScript -->
          </div>
        </div>

        <div class="wrapper flex items-center justify-center">
          <div class="flex-1 flex items-center" style="min-width: 60%">
            <img class="icon1 h-20 object-contain" src="./assets/image/资源 6.png" alt="" />
            <img class="icon2 object-contain bottom-4 relative" src="./assets/image/资源 3.png" alt="" />
          </div>
          <div class="flex flex-wrap items-center justify-bewteen gap-2 flex-grow" id="blueHeartsContainer">
            <!-- Heart icons will be generated by JavaScript -->
          </div>
        </div>
      </div>
    </div>

    <script>
      // Function to generate heart icons for a specific color type
      function generateHeartIcons(containerId, colorClass, colorType, count = 12) {
        const container = document.getElementById(containerId);

        // Clear any existing content
        container.innerHTML = '';

        // Generate the specified number of heart icons
        for (let i = 0; i < count; i++) {
          const img = document.createElement('img');
          img.className = `icon3 object-contain cursor-pointer ${colorClass}`;
          img.setAttribute('data-key', i.toString());
          img.setAttribute('src', `./assets/icon/${colorType}色爱心-空.png`);
          img.setAttribute('alt', '');
          container.appendChild(img);
        }
      }

      // Generate the heart icons for each color
      generateHeartIcons('redHeartsContainer', 'red', '红');
      generateHeartIcons('yellowHeartsContainer', 'yellow', '黄');
      generateHeartIcons('blueHeartsContainer', 'blue', '蓝');

      const redHearts = document.querySelectorAll('.red');
      const blueHearts = document.querySelectorAll('.blue');
      const yellowHearts = document.querySelectorAll('.yellow');

      // Store heart collections in a map for easier access
      const heartsMap = {
        红: redHearts,
        蓝: blueHearts,
        黄: yellowHearts,
      };

      function clickFn(el, type) {
        const key = el.getAttribute('data-key');
        const index = Number(key);
        activateImages(index, type);
      }

      // Add event listeners to all heart icons
      redHearts.forEach((el) => {
        el.addEventListener('click', () => clickFn(el, '红'));
      });

      blueHearts.forEach((el) => {
        el.addEventListener('click', () => clickFn(el, '蓝'));
      });

      yellowHearts.forEach((el) => {
        el.addEventListener('click', () => clickFn(el, '黄'));
      });

      // Unified function to handle heart activation for any color
      function activateImages(index, type) {
        const hearts = heartsMap[type];
        if (!hearts) return;

        const clickedHeart = hearts[index];
        const wasActivated = clickedHeart.getAttribute('activated') === 'true';

        hearts.forEach((image, idx) => {
          if (wasActivated && idx === index) {
            // If clicking on an already activated heart, deactivate it
            image.setAttribute('src', `./assets/icon/${type}色爱心-空.png`);
            image.setAttribute('activated', 'false');
          } else if (idx <= index && (!wasActivated || idx < index)) {
            // Activate this heart and all hearts before it
            image.setAttribute('src', `./assets/icon/${type}色爱心-实.png`);
            image.setAttribute('activated', 'true');
          } else {
            // Deactivate all hearts after the clicked one
            image.setAttribute('src', `./assets/icon/${type}色爱心-空.png`);
            image.setAttribute('activated', 'false');
          }
        });
      }
    </script>
  </body>
</html>
